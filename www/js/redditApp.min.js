(function(){window.console||(console={log:function(){}});var my={};return my.defaultCategory="funny",my.category=my.defaultCategory,my.pages=[],my.articles=[],my.currentPage=0,my.before=null,my.after=null,my.urlParts=Array("https://www.reddit.com/r/","/.json"),my.ready=null,my.startCheck=function(){my.ready=setInterval(my.checkForJQuery,10)},my.checkForJQuery=function(){"undefined"!=typeof window.jQuery&&(clearInterval(my.ready),my.ready=null,$(document).ready(my.init))},my.addPageNavigation=function(before,after){$(".navigation").remove();var navigation=$.trim($("#articleNavigation").html()),currentNavigation=$(navigation).clone();null!=before?currentNavigation.find(".prevPage").bind("click",function(e){my.currentPage--,my.currentPage<=0?(my.currentPage=0,my.getData(my.category)):my.getData(void 0,String("after="+my.pages[my.currentPage]))}):currentNavigation.find(".prevPage").remove(),null!=after?currentNavigation.find(".nextPage").bind("click",function(e){my.getData(void 0,String("after="+after)),my.pages.push(after),my.currentPage++}):currentNavigation.find(".nextPage").remove(),$(".articles_area").append(currentNavigation)},my.showArticles=function(output){$(".articles_area").empty(),my.gotoTopOfPage();var template=null,currentrow=null;delete my.articles,my.articles=null,my.articles=[],template=$.trim($("#articleTemplate").html());for(var i in output.data.children){var rowclass=i%2==0?"odd":"",article=output.data.children[i].data;my.articles.push(output.data.children[i].data),currentrow=$(template).clone(),$(currentrow).addClass(rowclass).attr("data-ref",i),Boolean(article.thumbnail.match(/^(nsfw|self|default)/i))||!Boolean(String(article.thumbnail).match(/\w/))?$(currentrow).find(".thumbnail").css("background-image","url(images/unknown.png)"):$(currentrow).find(".thumbnail").css("background-image","url("+article.thumbnail+")"),$(currentrow).find(".title").text(article.title),$(currentrow).find(".author").text(article.author),$(currentrow).find(".num_comments em").text(String(article.num_comments)),$(currentrow).find(".ups em").text(String(article.ups)),$(currentrow).find(".downs em").text(String(article.downs)),$(".articles_area").append(currentrow)}$(".article").bind("click",my.showArticleActions),my.addPageNavigation(output.data.before,output.data.after),my.checkForNoValueInSearch(),currentrow=template=null},my.checkForNoValueInSearch=function(){var searchval=$(".search_field").val();Boolean(searchval.match(/\w/))||$(".search_field").val(my.defaultCategory)},my.gotoTopOfPage=function(){var body=$("body, html");0!=body.scrollTop()&&body.stop().animate({scrollTop:0},1e3)},my.getData=function(category,direction){"undefined"!=typeof category&&"undefined"==typeof direction&&(my.category=category),Boolean(my.category.match(/\w/))||(my.category=my.defaultCategory);var urlParams="";"undefined"!=typeof direction&&(urlParams="?count=25&"+direction);var fullURL=String(my.urlParts[0]+my.category+my.urlParts[1]+urlParams),promise=$.ajax({url:fullURL,dataType:"json",type:"GET"});promise.success(my.showArticles),promise.error(function(jqXHR,textStatus,errorThrown){console.log(jqXHR.responseText)})},my.searchFieldAction=function(keepClass){my.getData($(".search_field").val()),"undefined"==typeof keepClass&&$(".search_field").removeClass("expanded")},my.showArticleActions=function(e){$(".actions").remove();var actions=$.trim($("#articleActions").html()),currentActions=$(actions).clone();$(e.currentTarget).attr("data-ref");$("body").append(currentActions).addClass("overlay")},my.assignFunctions=function(){$(".search_field").focus(function(){var text=String($(this).val());$(this).addClass("expanded"),Boolean(text.match(/\w/i))||$(this).val("")}).val(my.category),$(".search_field").blur(function(){my.searchFieldAction()}),$(".search_field").keypress(function(e){13==e.which&&(e.preventDefault(),my.searchFieldAction(!0))}),$(".search_field").keyup(function(e){String($(this).val()).length>2&&my.searchFieldAction(!0)})},my.init=function(){my.getData(),my.assignFunctions()},my})().startCheck();