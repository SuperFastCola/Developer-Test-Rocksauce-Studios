(function(){window.console||(console={log:function(){}});var my={};return my.defaultCategory="funny",my.category=my.defaultCategory,my.pages=[],my.articles=[],my.currentPage=0,my.before=null,my.after=null,my.urlParts=Array("https://www.reddit.com/r/","/.json"),my.ready=null,my.startCheck=function(){my.ready=setInterval(my.checkForJQuery,10)},my.checkForJQuery=function(){"undefined"!=typeof window.jQuery&&(clearInterval(my.ready),my.ready=null,$(document).ready(my.init))},my.addPageNavigation=function(before,after){$(".navigation").remove();var currentNavigation=my.returnHtmlTemplate("articleNavigation");null!=before?currentNavigation.find(".prevPage").bind("click",function(e){my.currentPage--,my.currentPage<=0?(my.currentPage=0,my.getData(my.category)):my.getData(void 0,String("after="+my.pages[my.currentPage]))}):currentNavigation.find(".prevPage").remove(),null!=after?currentNavigation.find(".nextPage").bind("click",function(e){my.getData(void 0,String("after="+after)),my.pages.push(after),my.currentPage++}):currentNavigation.find(".nextPage").remove(),$(".articles_area").append(currentNavigation)},my.returnBackCSS=function(imgSrc){return Boolean(imgSrc.match(/^(nsfw|self|default)/i))||!Boolean(String(imgSrc).match(/\w/))?{"background-image":"url(images/unknown.png)"}:{"background-image":"url("+imgSrc+")"}},my.showArticles=function(output){$(".articles_area").empty(),my.gotoTopOfPage();var template=null,currentrow=null;delete my.articles,my.articles=null,my.articles=[],template=$.trim($("#articleTemplate").html());for(var i in output.data.children){var rowclass=i%2==0?"odd":"",article=output.data.children[i].data;my.articles.push(output.data.children[i].data),currentrow=$(template).clone(),$(currentrow).addClass(rowclass).attr("data-ref",i),$(currentrow).find(".thumbnail").css(my.returnBackCSS(article.thumbnail)),$(currentrow).find(".title").text(article.title),$(currentrow).find(".author").text(article.author),$(currentrow).find(".num_comments em").text(String(article.num_comments)),$(currentrow).find(".ups em").text(String(article.ups)),$(currentrow).find(".downs em").text(String(article.downs)),$(".articles_area").append(currentrow)}$(".article").bind("click",my.showarticleActions),my.addPageNavigation(output.data.before,output.data.after),my.checkForNoValueInSearch(),currentrow=template=null},my.checkForNoValueInSearch=function(){var searchval=$(".search_field").val();Boolean(searchval.match(/\w/))||$(".search_field").val(my.defaultCategory)},my.gotoTopOfPage=function(){var body=$("body, html");0!=body.scrollTop()&&body.stop().animate({scrollTop:0},1e3)},my.getData=function(category,direction){"undefined"!=typeof category&&"undefined"==typeof direction&&(my.category=category),Boolean(my.category.match(/\w/))||(my.category=my.defaultCategory);var urlParams="";"undefined"!=typeof direction&&(urlParams="?count=25&"+direction);var fullURL=String(my.urlParts[0]+my.category+my.urlParts[1]+urlParams),promise=$.ajax({url:fullURL,dataType:"json",type:"GET"});promise.success(my.showArticles),promise.error(function(jqXHR,textStatus,errorThrown){console.log(jqXHR.responseText)})},my.returnHtmlTemplate=function(id){var template=$.trim($(String("#"+id)).html());return $(template).clone()},my.searchFieldAction=function(keepClass){my.getData($(".search_field").val()),"undefined"==typeof keepClass&&$(".search_field").removeClass("expanded")},my.removeBackgroundTimeout=function(){my.addRemoveActionsClick()},my.snapBackObject=function(id,delay){var butn=document.getElementById(id),coord=String($(butn).attr("data-ref")).split(":"),props={x:coord[0],y:coord[1],onComplete:function(){$("#articleButton").removeClass("fiftyPercent"),setTimeout(my.removeBackgroundTimeout,1e3)}};"undefined"!=typeof delay&&(props.delay=.5),TweenLite.to(butn,.25,props)},my.addRemoveActionsClick=function(remove){"undefined"!=typeof remove?$("#actions").unbind("click",my.removeOverlay):$("#actions").bind("click",my.removeOverlay)},my.removeOverlay=function(){$("#actions").remove(),$("body").removeClass("overlay")},my.showarticleActions=function(e){var actionArea=my.returnHtmlTemplate("articleActions"),currentArticle=my.articles[$(e.currentTarget).attr("data-ref")];actionArea.find(".title").text(currentArticle.title),actionArea.find(".thumbnail").css(my.returnBackCSS(currentArticle.thumbnail)),$("body").append(actionArea).addClass("overlay"),TweenLite.to("#actions",.25,{opacity:1}),my.addRemoveActionsClick(),Draggable.create("#articleButton",{type:"x,y",edgeResistance:.65,bounds:"#actions",onDragStart:function(){var attr=$("#articleButton").attr("data-ref");$("#articleButton").addClass("fiftyPercent"),"undefined"==typeof attr&&$("#articleButton").attr("data-ref",String(this.x+":"+this.y))},onDragEnd:function(){var url="https://www.reddit.com"+currentArticle.permalink;my.addRemoveActionsClick(!0),this.hitTest("#redditLink","80%")?(window.open(url,"redditLink"),my.snapBackObject("articleButton",!0)):this.hitTest("#emailLink","80%")?(window.location.href="mailto:?subject=Check%20out%20this%20Reddit%20post&body="+url,my.snapBackObject("articleButton",!0)):my.snapBackObject("articleButton")}})},my.assignFunctions=function(){$(".search_field").focus(function(){var text=String($(this).val());$(this).addClass("expanded"),Boolean(text.match(/\w/i))||$(this).val("")}).val(my.category),$(".search_field").blur(function(){my.searchFieldAction()}),$(".search_field").keypress(function(e){13==e.which&&(e.preventDefault(),my.searchFieldAction(!0))}),$(".search_field").keyup(function(e){String($(this).val()).length>2&&my.searchFieldAction(!0)})},my.init=function(){my.getData(),my.assignFunctions()},my})().startCheck();